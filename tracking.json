async function trackShipment() {
    // 1. Get what the user typed
    const trackingId = document.getElementById('trackingInput').value.trim();
    const resultDiv = document.getElementById('result');
    
    // Clear previous results
    resultDiv.innerHTML = '<p class="text-gray-500">Searching...</p>';

    if (!trackingId) {
        resultDiv.innerHTML = '<p class="text-red-500">Please enter a tracking number.</p>';
        return;
    }

    try {
        // 2. The "Handshake": Try to find the specific JSON file for this ID
        // Note: We look in the folder where Admin saves them: /content/shipments/
        const response = await fetch(`/content/shipments/${trackingId}.json`);

        // 3. If the file is not found (404 error)
        if (!response.ok) {
            throw new Error("Shipment not found");
        }

        // 4. If found, read the data
        const data = await response.json();

        // 5. Show the data on the screen
        resultDiv.innerHTML = `
            <div class="bg-white p-6 rounded-lg shadow-md border-l-4 border-blue-500 text-left">
                <h3 class="text-xl font-bold text-gray-800 mb-2">ðŸ“¦ Shipment Found</h3>
                <p><strong>Tracking ID:</strong> ${data.tracking_id}</p>
                <p><strong>Status:</strong> <span class="px-2 py-1 rounded text-sm font-bold ${getStatusColor(data.status)}">${data.status}</span></p>
                <p><strong>Location:</strong> ${data.location}</p>
                <p><strong>Estimated Delivery:</strong> ${new Date(data.delivery_date).toDateString()}</p>
                
                <hr class="my-4">
                
                <h4 class="font-bold text-gray-700">Package Details</h4>
                <p><strong>Item:</strong> ${data.package.description}</p>
                <p><strong>Weight:</strong> ${data.package.weight} kg</p>
                
                <div class="mt-4">
                    ${data.package.image ? `<img src="${data.package.image}" class="w-full max-w-xs rounded-lg shadow-sm" alt="Package Image">` : ''}
                </div>
            </div>
        `;

    } catch (error) {
        // If the ID doesn't exist
        resultDiv.innerHTML = `
            <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded">
                <strong>Error:</strong> Tracking ID "${trackingId}" not found. Please check and try again.
            </div>
        `;
    }
}

// Helper function to pick colors based on status
function getStatusColor(status) {
    if (status === 'Delivered') return 'bg-green-100 text-green-800';
    if (status === 'Pending') return 'bg-yellow-100 text-yellow-800';
    if (status === 'On Hold') return 'bg-red-100 text-red-800';
    return 'bg-blue-100 text-blue-800'; // Default for In Transit
}
